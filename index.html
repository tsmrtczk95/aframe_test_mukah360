<html>
  <head>
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-template-component@3.x.x/dist/aframe-template-component.min.js"></script>
    <script src="https://unpkg.com/aframe-layout-component@5.x.x/dist/aframe-layout-component.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.x.x/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/aframe-proxy-event-component@2.1.0/dist/aframe-proxy-event-component.min.js"></script> -->
    <!-- <script id="link" type="text/html">
        <a-entity class="link"
          geometry="primitive: plane; height: 0.9 width: 1.2"
          material="shader: flat; src: ${thumb}"
          sound="on: click; src: #click-sound"
          event-set__mouseenter="scale: 1.2 1.2 1"
          event-set__mouseleave="scale: 1 1 1"
          event-set__click="_target: #image-360; _delay: 300; material.src: ${src}">
          proxy-event="event: click; to: #image-360; as: fade></a-entity></script> -->
    
    <!-- <script id="hotspot-template" type="text/html">
      <a-entity class="hotspot"
      geometry="primitive: sphere; radius: 0.15"
      material="color: #FFD700; opacity: 0.9"
      look-at="[camera]"
      position="${pos}"
          
      event-set__mouseenter="scale: 1.4 1.4 1.4"
      event-set__mouseleave="scale: 1 1 1"
          
      event-set__click="_target: #image-360; _delay: 300; material.src: ${src}"
      proxy-event="event: click; to: #image-360; as: fade">
          
      <!-- Thumbnail preview -->
    <!--  <a-plane class="preview"
      visible="false"
      position="0 0.3 0"
      width="0.8"
      height="0.5"
      material="src: ${thumb}; shader: flat">
      </a-plane>
          
      <a-animation
      attribute="children[0].visible"
      begin="mouseenter"
      dur="10"
      to="true">
      </a-animation>
          
      <a-animation
      attribute="children[0].visible"
      begin="mouseleave"
      dur="10"
      to="false">
      </a-animation>
      </a-entity></script> -->
  </head>
  <body>
    <a-scene>
      <a-assets>
        <audio id="click-sound" src="https://cdn.aframe.io/360-image-gallery-boilerplate/audio/click.ogg"></audio>
        <!-- Images Custom. -->
        <img id="img-enter" src="asset_360/kaul_entrance.jpeg">
        <img id="img-stage" src="asset_360/kaul_stage.jpeg">
        <img id="img-signage" src="asset_360/kaul_signage.jpeg">
        <img id="img-tibau" src="asset_360/kaul_tibau.jpeg">
        <!-- Thumbnails -->
        <img id="tibau-thumb" src="asset_360/thumbnail_tibau.jpeg">
        <img id="enter-thumb" src="asset_360/thumbnail_entrance.jpeg">
        <img id="stage-thumb" src="asset_360/thumbnail_stage.jpeg">
        
        <script id="link" type="text/html">
          <a-entity class="hotspot"
          geometry="primitive: sphere; radius: 0.2"
          material="color: #FFCC00; opacity: 0.9" position="${pos}"
          sound="on: click; src: #click-sound"
          event-set__mouseenter="scale: 1.4 1.4 1.4"
          event-set__mouseleave="scale: 1 1 1"
          event-set__click="_target: #image-360; _delay: 300; material.src: ${src}"></a-entity></script>
        
      </a-assets>
      <!-- 360-degree image. -->
      <a-sky id="image-360" src="#img-enter" rotation="0 -55 0"
        animation__fadeout="material.color; from: #FFF; to: #000; dur: 400; startEvents: fadeout"
        animation__fadein="material.color; from: #000; to: #FFF; dur: 400; startEvents: fadein"></a-sky>
      <!-- Hotspot SCENE 1 -->
      <a-entity id="hotspots-enter">
        <a-entity template="src: #link" data-src="#img-tibau" data-pos="2 1 -3"></a-entity>
        <a-entity template="src: #link" data-src="#img-stage" data-pos="-1 0.5 -3"></a-entity> </a-entity>
      <!-- Hotspot SCENE 2 -->
      <a-entity id="hotspots-tibau" visible="false">
        <a-entity template="src: #link" data-src="#img-enter" data-pos="1 1 -3"></a-entity>
        <a-entity template="src: #link" data-src="#img-stage" data-pos="-2 0.5 -2"></a-entity></a-entity>
      <!-- Hotspot SCENE 3 -->
      <a-entity id="hotspots-stage" visible="false">
        <a-entity template="src: #link" data-src="#img-enter" data-pos="-1 1 -3"></a-entity>
        <a-entity template="src: #link" data-src="#img-tibau" data-pos="2 1 -2"></a-entity>></a-entity>

      <!-- <a-entity id="hotspots">
        <a-entity class="hotspot"
          geometry="primitive: sphere; radius: 0.15"
          material="color: #FFC300; shader: flat"
          position="2 1 -3"
          event-set__click="_target: #image-360; material.src: ${src}; _delay: 50; emit: fadeout"
          event-set__click2="_target: #image-360; emit: fadein"
          event-set__mouseenter="scale: 1.4 1.4 1.4"
          event-set__mouseleave="scale: 1 1 1">
          </a-entity>
        </a-entity>
      <!-- Show Thumbnails on Hover -->
      <!-- <a-entity id="preview" visible="false" geometry="primitive: plane; height: 1; width: 1.8"
        material="shader: flat; src: #enter-thumb" position="0 1.5 -2"></a-entity>
      <!-- Camera + Cursor. -->
      <a-camera wasd-controls="enabled: false" 
        look-controls="pointerLockEnabled: false; touchEnabled: true; reverseMouseDrag: false; touchPitch: true">
        <a-cursor
          id="cursor"
          animation__click="property: scale; from: 0.1 0.1 0.1; to: 1 1 1; easing: easeInCubic; dur: 150; startEvents: click"
          animation__clickreset="property: scale; to: 0.1 0.1 0.1; dur: 1; startEvents: animationcomplete__click"
          animation__fusing="property: scale; from: 1 1 1; to: 0.1 0.1 0.1; easing: easeInCubic; dur: 150; startEvents: fusing"></a-cursor>
        </a-camera>
      </a-scene>
    <script>
      const sky = document.querySelector('#image-360');
      
      sky.addEventListener('materialtextureloaded', function () {
        const src = sky.getAttribute('src');
        
        // Hide all hotspot groups
        document.querySelector('#hotspots-enter').setAttribute('visible', false);
        document.querySelector('#hotspots-tibau').setAttribute('visible', false);
        document.querySelector('#hotspots-stage').setAttribute('visible', false);
        
        // Activate relevant group
        if (src === '#img-enter') {
          document.querySelector('#hotspots-enter').setAttribute('visible', true);
          }
          else if (src === '#img-tibau') {
            document.querySelector('#hotspots-tibau').setAttribute('visible', true);
            }
            else if (src === '#img-stage') {
              document.querySelector('#hotspots-stage').setAttribute('visible', true);
              }
        });
</script>

  </body>
</html>
